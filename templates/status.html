<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>System Status</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        .status-grid { display:flex; flex-direction:column; gap:8px; }
        .status-item { display:flex; align-items:center; gap:8px; }
        .dot { width:12px; height:12px; border-radius:50%; background:red; }
        .dot.green { background: #66bb6a; }
    </style>
</head>
<body>
<header class="navbar">
    <div class="nav-links">
        <a href="/">Chat</a>
        <a href="/lmchat">LM Chat</a>
        <a href="/commands">Commands</a>
        <a href="/system">System Status</a>
        <a href="/?settings=1" class="settings-link">Settings</a>
    </div>
    <div id="status-lights" class="status-lights"></div>
</header>
<div class="chat-container">
    <h1>System Status</h1>
    <div id="status" class="status-grid"></div>
</div>
<script>
async function refreshStatus(){
    const res=await fetch('/status');
    const data=await res.json();
    const container=document.getElementById('status');
    container.innerHTML='';
    for(const [name, ok] of Object.entries(data)){
        const item=document.createElement('div');
        item.className='status-item';
        const dot=document.createElement('div');
        dot.className='dot'+(ok?' green':'');
        item.appendChild(dot);
        const span=document.createElement('span');
        span.textContent=name+(ok?' online':' offline');
        item.appendChild(span);
        container.appendChild(item);
    }
}
refreshStatus();
setInterval(refreshStatus, 10000);
</script>
<script src="/static/status.js"></script>
<div class="workflow-container">
    <svg class="workflow-svg" viewBox="0 0 620 160">
        <rect x="10" y="90" width="110" height="30" class="node"/>
        <text x="65" y="108">Chat/Commands</text>
        <rect x="150" y="90" width="100" height="30" class="node"/>
        <text x="200" y="108">Planner</text>
        <rect x="280" y="90" width="100" height="30" class="node"/>
        <text x="330" y="108">Validator</text>
        <rect x="410" y="90" width="100" height="30" class="node"/>
        <text x="460" y="108">Executor</text>
        <rect id="node-n8n" x="540" y="90" width="70" height="30" class="node status-node"/>
        <text x="575" y="108">N8N</text>
        <line x1="120" y1="105" x2="150" y2="105" class="arrow"/>
        <line x1="250" y1="105" x2="280" y2="105" class="arrow"/>
        <line x1="380" y1="105" x2="410" y2="105" class="arrow"/>
        <line x1="510" y1="105" x2="540" y2="105" class="arrow"/>

        <rect x="10" y="20" width="110" height="30" class="node"/>
        <text x="65" y="38">LM Chat</text>
        <line x1="120" y1="35" x2="280" y2="35" class="arrow"/>
        <rect id="node-lmstudio" x="280" y="20" width="100" height="30" class="node status-node"/>
        <text x="330" y="38">LM Studio</text>

        <rect id="node-anythingllm" x="280" y="140" width="100" height="30" class="node status-node"/>
        <text x="330" y="158">AnythingLLM</text>
        <line x1="200" y1="120" x2="330" y2="140" class="arrow"/>
        <line x1="200" y1="50" x2="330" y2="35" class="arrow"/>
    </svg>
</div>
</body>
</html>
